<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BugObserve for AI Agents ‚Äì Admin</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <h1>BugObserve for AI Agents</h1>
      <p class="subtitle">Amministrazione endpoint log v2.0</p>
    </div>
    <div class="header-actions">
      <button id="btn-theme" class="icon-btn" title="Tema notte/chiaro" aria-label="Tema notte/chiaro" data-mode="dark">
        <svg class="svg-sun" viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="4" />
          <path d="M12 2v2M12 20v2M4 12H2M22 12h-2M5 5l1.5 1.5M17.5 17.5L19 19M5 19l1.5-1.5M17.5 6.5L19 5" />
        </svg>
        <svg class="svg-moon" viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
          <path d="M21 12.79A9 9 0 1111.21 3a7 7 0 109.79 9.79z" fill="currentColor" />
        </svg>
      </button>
      <a id="btn-bug" class="icon-btn" href="mailto:eyeart.agency@gmail.com?subject=Segnalazione%20bug%20VS%20Code%20Debug%202.0" title="Segnala un bug" aria-label="Segnala un bug">
        <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="7" r="2" />
          <ellipse cx="12" cy="14" rx="5" ry="6" />
          <path d="M7 14h10M6 11l3 2M18 11l-3 2M6 17l3-2M18 17l-3-2" />
        </svg>
      </a>
      <button id="btn-logout" class="icon-btn" title="Logout" aria-label="Logout">
        <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
      </button>
    </div>
  </header>

  <main class="container">
    <div id="unsaved-changes" class="warning-banner" style="display: none;">
      <span>‚ö†Ô∏è Ricordati di salvare la configurazione</span>
    </div>
    <section class="panel">
      <h2>Configurazione API Log</h2>
      <div class="grid-2">
        <div>
          <label class="toggle">
            <input type="checkbox" id="api-enabled" />
            <span>Abilita API</span>
          </label>
          <div class="field-row">
            <label for="api-key">Chiave API</label>
            <div class="inline">
              <input id="api-key" type="text" readonly>
              <button id="btn-generate" class="danger">Genera Nuova Chiave API</button>
            </div>
          </div>
        </div>
        <div>
          <h3>Stato del Sistema</h3>
          <div class="status">
            <div>
              <small>Endpoint API</small>
              <code id="endpoint-url" class="copyable" data-tip="Clicca per copiare" aria-label="Clicca per copiare"></code>
            </div>
            <div>
              <small>URL Controllo / Accesso Diretto</small>
              <code id="endpoint-direct" class="copyable" data-tip="Clicca per copiare" aria-label="Clicca per copiare"></code>
            </div>
            
          </div>
        </div>
      </div>
    </section>

    <section class="panel">
      <div class="columns">
        <div class="col">
          <h2>Log files da esporre dagli Endpoint</h2>
          <div id="drop-hint" class="hint">Trascina qui i file di log dal riquadro a destra</div>
          <ul id="log-list" class="log-list" aria-live="polite"></ul>
          <div class="actions">
            <button id="btn-add-row" class="secondary">Aggiungi riga</button>
            <button id="btn-save" class="primary">Salva configurazione</button>
          </div>
        </div>
        <div class="col">
          <div class="header-row">
            <h2>Struttura cartelle</h2>
            <div class="inline">
              <button id="btn-fetch-tree" class="secondary">Fetch cartelle</button>
              <button id="btn-expand-all" class="secondary">Espandi tutto</button>
              <button id="btn-collapse-all" class="secondary">Comprimi tutto</button>
            </div>
          </div>
          <div id="tree-container" class="tree" role="tree"></div>
          <div class="info-box">
            <p><strong>‚ÑπÔ∏è Come usare:</strong></p>
            <p>Trascina i file dall'explorer al campo di input nel box "Nomi file di log da esaminare" per aggiungere i file all'esposizione.</p>
            <p><strong>NOTA BENE:</strong> Nell'explorer vengono visualizzati solo file con estensione .log, .txt o .err.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="panel">
      <h2>Test endpoint</h2>
      <button id="btn-test" class="primary">Testa endpoint</button>
      <pre id="test-output" class="output" aria-live="polite"></pre>
    </section>

    <section class="panel">
      <h2>üîê Sicurezza e Account</h2>
      <div class="columns">
        <div class="col">
          <h3>Cambia Password</h3>
          <div class="password-change-form">
            <div class="field-row">
              <label for="current-password">Password Attuale</label>
              <input type="password" id="current-password" autocomplete="current-password" />
            </div>
            <div class="field-row">
              <label for="new-password">Nuova Password</label>
              <input type="password" id="new-password" autocomplete="new-password" />
              <small class="field-help">Minimo 8 caratteri, consigliati 12+</small>
            </div>
            <div class="field-row">
              <label for="confirm-password">Conferma Nuova Password</label>
              <input type="password" id="confirm-password" autocomplete="new-password" />
            </div>
            <div class="password-strength" id="password-strength"></div>
            <button id="btn-change-password" class="primary">Cambia Password</button>
          </div>
        </div>
        <div class="col">
          <h3>Impostazioni di Sicurezza</h3>
          <div class="security-unified">
            <div class="account-status">
              <div class="info-item">
                <strong>üë§ Account:</strong> <span id="admin-username">admin</span>
              </div>
              <div class="info-item">
                <strong>‚è±Ô∏è Sessione scade tra:</strong> <span id="session-expires">-</span>
              </div>
            </div>
            
            <div class="security-controls">
              <h4>Protezione Brute Force</h4>
              <div class="field-row compact">
                <label for="max-attempts">Tentativi massimi login</label>
                <input id="max-attempts" type="number" min="3" max="100" value="10" />
                <small class="field-help">Tentativi prima del blocco IP</small>
              </div>
              
              <div class="field-row compact">
                <label for="block-duration">Durata blocco (secondi)</label>
                <input id="block-duration" type="number" min="60" max="86400" value="300" />
                <small class="field-help">Tempo di blocco dopo tentativi falliti</small>
              </div>
              
              <div class="field-row compact">
                <label for="session-timeout">Timeout sessione (minuti)</label>
                <input id="session-timeout" type="number" min="5" max="1440" value="30" />
                <small class="field-help">Logout automatico dopo inattivit√†</small>
              </div>
            </div>
            
            <div class="security-note">
              <p class="hint">üí° Queste impostazioni si applicano sia al login admin che all'API endpoint</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="columns">
      <section class="panel security-warning">
        <h2>‚ö†Ô∏è Sicurezza</h2>
        <div class="warning-content">
          <p><strong>ATTENZIONE:</strong> Ricordati di proteggere la tua cartella in ambiente di produzione inserendo un .htaccess corretto!</p>
          <p>Questo impedir√† accessi non autorizzati ai file di configurazione e ai log.</p>
          <button id="btn-download-htaccess" class="primary">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="margin-right: 6px;">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Scarica .htaccess di esempio
          </button>
          <small style="display: block; margin-top: 10px; color: var(--muted);">
            Dopo il download, rinomina il file in .htaccess e posizionalo nella cartella bugobserve-ai-agents
          </small>
        </div>
      </section>
      
      <section class="panel danger-section">
        <h2>üîÑ Reset completo</h2>
        <div class="danger-box">
          <p><strong>‚ö†Ô∏è ATTENZIONE:</strong> Questa operazione:</p>
          <ul>
            <li>Rigenera una nuova chiave API</li>
            <li>Reimposta la configurazione</li>
            <li>Pulisce la lista dei file</li>
            <li>Ripristina le impostazioni di sicurezza ai valori predefiniti</li>
          </ul>
          <p style="margin-top: 12px; color: var(--danger);">
            <strong>Questa azione √® irreversibile!</strong>
          </p>
          <button id="btn-reset" class="danger" style="width: 100%; margin-top: 16px;">
            üóëÔ∏è Esegui Reset Completo
          </button>
        </div>
      </section>
    </div>
  </main>

  <div id="toast" class="toast" aria-live="polite"></div>

  <footer class="app-footer">
    <small>BugObserve for AI Agents v2.0 ‚Äì Standalone utility</small>
  </footer>

  <template id="row-template">
    <li class="log-row">
      <div class="drag-handle" draggable="true" title="Trascina per riordinare">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="8" cy="6" r="1.5" fill="currentColor"/>
          <circle cx="16" cy="6" r="1.5" fill="currentColor"/>
          <circle cx="8" cy="12" r="1.5" fill="currentColor"/>
          <circle cx="16" cy="12" r="1.5" fill="currentColor"/>
          <circle cx="8" cy="18" r="1.5" fill="currentColor"/>
          <circle cx="16" cy="18" r="1.5" fill="currentColor"/>
        </svg>
      </div>
      <input type="text" class="path" readonly placeholder="/percorso/al/file.log" />
      <button class="remove">Rimuovi</button>
      <button class="expand" title="Opzioni / Filtri" aria-label="Espandi opzioni">
        <svg class="icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M9 6l6 6-6 6" />
        </svg>
      </button>
      <div class="details">
        <label class="field">
          <span>Da data</span>
          <input type="date" class="from-date" />
        </label>
        <label class="field">
          <span>Ora</span>
          <input type="time" class="from-time" step="1" />
        </label>
        <label class="chk">
          <input type="checkbox" class="hide-log" /> Non mostrare
        </label>
        <label class="chk">
          <input type="checkbox" class="force-date" /> Forza filtro data
        </label>
        <label class="chk">
          <input type="checkbox" class="delete-after" /> Cancella dopo la lettura
        </label>
        <label class="field">
          <span>Limite caratteri (0 = illimitato)</span>
          <input type="number" class="char-limit" min="0" value="0" placeholder="0" />
        </label>
      </div>
    </li>
  </template>

  <script src="app.js"></script>
</body>
</html>


